(function(B){var A=/([^&=]+)=?([^&]*)/g;var D=/\+/g;var C=function(E){return decodeURIComponent(E.replace(D," "));};B.parseParams=function(G){var I={},H;while(H=A.exec(G)){var F=C(H[1]),E=C(H[2]);if(F.substring(F.length-2)==="[]"){F=F.substring(0,F.length-2);(I[F]||(I[F]=[])).push(E);}else{I[F]=E;}}return I;};B.substitute=function(F,E){return F.replace(/\{(.+?)\}/g,function(H,G){return G in E?E[G]:H;});};})(jQuery);var TWP=window.TWP||{};(function(A){TWP.Overlay=function(G,E){var C=this;var D=this.config={top:"center",left:"center",fixed:false,speed:"fast",showOverlay:true,loadSpeed:100,overlayOpacity:0.7,overlayColor:"black"};var B=function(){A.extend(D,E);if(!G){G=A("<div/>").css("width",100).css("height",100);}if(!C.overlay){C.id="overlay_"+new Date().getTime();C.contentWrapperId="wrapper_"+C.id;var H=A("<div/>",{id:C.id}).addClass("simple-overlay modal-wrapper");H.append(A("<div/>",{id:C.contentWrapperId}).addClass("content-wrapper photo-display"));A("body").prepend(H);C.overlay=H.overlay({mask:{color:D.overlayColor,loadSpeed:D.loadSpeed,opacity:D.overlayOpacity,zIndex:55554},top:D.top,left:D.left,onBeforeLoad:function(I){C.setBody(G);if(D.onBeforeLoad){D.onBeforeLoad(I);}},onLoad:D.onLoad?D.onLoad:function(){},onBeforeClose:D.onBeforeClose?D.onBeforeClose:function(){},onClose:D.onClose?D.onClose:function(){},load:D.showOverlay,fixed:D.fixed,speed:D.speed});TWP.currentOverlay=C.overlay;F();}else{C.show();}};var F=function(){if(D.callback){D.callback(C);}};this.show=function(){A("#"+C.id).overlay().load();};this.destroy=function(){if(C.overlay){var H=A("#"+C.id);H.overlay().close();H.remove();C.overlay=null;}};this.close=function(){var H=A("#"+C.id).overlay();if(H.isOpened()){H.close();}};this.setBody=function(I){var H=A("#"+this.contentWrapperId);H.html(typeof I=="string"?I:I[0].outerHTML?I[0].outerHTML:I[0]);};this.getBody=function(){return A("#"+this.contentWrapperId);};B.apply(this);return C;};}(jQuery));TWP=window.TWP||{};(function(A){TWP.OverlayHelper=function(F,D){var E=this.config={url:"",overlayConfig:{},overlay:null};this.initialize=function(){if(F){var G=this;this.resetConfigOnClick();A(F).bind("click",function(H){if(H){H.preventDefault();}G.resetConfigOnClick();A.extend(E.overlayConfig,D);C(null,E.overlayConfig);});}};this.resetConfigOnClick=function(){if(F){if(F.getAttribute("href")){E.url=F.getAttribute("href");}if(F.getAttribute("config")){E.overlayConfig=A.parseParams(F.getAttribute("config"));}}};var C=function(J,I){I=I?I:E.overlayConfig;E.url=J?J:E.url;var H=A(F);if(E.overlay){E.overlay.destroy();}if(H.hasClass("ajax-overlay")){var K=0,G=function(){if(K<5){A.ajax({url:E.url,success:B(I),error:G});K++;}else{B(I)("<p>Failed to download content after 5 tries</p>");}};G();}else{if(H.hasClass("iframe-overlay")){E.overlay=new TWP.Overlay(A("<iframe/>",{frameborder:"0",marginheight:"0px",marginwidth:"0px",width:I.width+"px",height:I.height+"px",src:E.url}),I);}else{if(H.hasClass("clone-overlay")){E.overlay=new TWP.Overlay(A("#"+F.getAttribute("rel")).clone(true),I);}}}};var B=function(G){return function(I){E.overlay=new TWP.Overlay(I,G);var H=E.overlay.getBody().find(".modal.ooyala-player");if(!!jQuery&&!!H.size()){A(E.overlay.overlay).data("overlay").onClose(function(){if(swfobject){var K=A("#"+TWP.ooyala.v3.players[TWP.ooyala.v3.players.length-1].playerContainerId).find("object").attr("id");swfobject.removeSWF(K);E.overlay.getBody().find(".ooyala-player-processed").remove();}});H.each(function(){A(this).removeClass("ooyala-player").addClass("ooyala-player-processed");new TWP.ooyala.v3.InlinePlayer(this);});}else{var J=E.overlay.getBody().find(".omni-player");if(J.length>0){A(E.overlay.overlay).data("overlay").onClose(function(){E.overlay.getBody().find(".omni-player").remove();});J.each(function(L,M){var K={};if(M.getAttribute("config")){K=A.parseParams(M.getAttribute("config"));}new TWP.Video.OmniPlayer(M,M.getAttribute("jsonURL"),K);});}}};};this.initialize();};}(jQuery));